<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Netflicks</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="nav" id="navContainer">
        <nav class="navbar">
            <div class="nav-links">
                <a href="index.html">Home</a>
                <a href="movie-section.html">Movies</a>
                <a href="tv-section.html">TV Shows</a>
                <a href="#">My List</a>
            </div>
            
            <div class="search-bar">
                <input type="text" class="search-bar" id="movie-search" placeholder="Search">
                <button type="submit" class="play-button" id="play-button">
                    <i class="fas fa-search"></i>
                </button>
            </div>
        </nav>
    </div>

    <div class="home" id="home">
        <div class="section" id="Marvel">
            <h2>Marvel Movies</h2>
            <div class="movie-list" id="marvelMovies"></div>
        </div>
        <div class="section" id="DC">
            <h2>DC Movies</h2>
            <div class="movie-list" id="dcMovies"></div>
        </div>
        <div class="section" id="StarWars">
            <h2>Star Wars Movies</h2>
            <div class="movie-list" id="starWarsMovies"></div>
        </div>
    </div>

    <script>
        // Function to fetch movie data from OMDB API
        async function fetchMovieData(title) {
            const apiKey = 'e5a0f4ec';
            const apiUrl = `https://www.omdbapi.com/?apikey=${apiKey}&t=${encodeURIComponent(title)}`;
            
            try {
                const response = await fetch(apiUrl);
                const data = await response.json();
                return data;
            } catch (error) {
                console.error('Error fetching movie data:', error);
                return null;
            }
        }

        // Function to display movies in a section
        async function fetchAndDisplayMovies(sectionId, movies) {
            const section = document.getElementById(sectionId);
            const movieList = section.querySelector('.movie-list');

            for (let i = 0; i < movies.length; i++) {
                const movieTitle = movies[i];
                const movieData = await fetchMovieData(movieTitle);

                if (movieData && movieData.Poster && movieData.Title && movieData.imdbID) {
                    const movieCard = document.createElement('div');
                    movieCard.classList.add('movie-card');

                    const posterLink = document.createElement('a');
                    const data = {
                        title: movieData.Title,
                        id: movieData.imdbID,
                        year: movieData.Year
                    };
                    const jsonString = JSON.stringify(data);
                    posterLink.href = `movie.html?data=${encodeURIComponent(jsonString)}`;

                    const posterImg = document.createElement('img');
                    posterImg.classList.add('movie-poster');
                    posterImg.src = movieData.Poster;
                    posterImg.alt = `${movieData.Title} Poster`;

                    posterLink.appendChild(posterImg);
                    movieCard.appendChild(posterLink);

                    movieList.appendChild(movieCard);
                }
            }
        }

        async function displayMovies() {
            await fetchAndDisplayMovies('Marvel', [
                "Avengers Endgame",
                "Avengers Infinity War",
                "Spider-Man No Way Home",
                "Black Panther",
                "Iron Man 3",
                "Captain America Civil War",
                "Spider-Man Far From Home",
                "Doctor Strange in the Multiverse of Madness",
                "Spider-Man 2",
                "Guardians of the Galaxy Vol. 3"
            ]);

            await fetchAndDisplayMovies('DC', [
                "Batman Begins",
                "Man of Steel",
                "Zack Snyder's Justice League",
                "Shazam!",
                "Joker",
                "Wonder Woman",
                "Aquaman",
                "Constantine",
                "The Batman",
                "The Suicide Squad"
            ]);

            await fetchAndDisplayMovies('StarWars', [
                "Star Wars: Episode IV - A New Hope",
                "Star Wars: Episode V - The Empire Strikes Back",
                "Star Wars: Episode VI - Return of the Jedi",
                "Star Wars: Episode I - The Phantom Menace",
                "Star Wars: Episode II - Attack of the Clones",
                "Star Wars: Episode III - Revenge of the Sith",
                "Rogue One: A Star Wars Story",
                "Solo: A Star Wars Story"
            ]);
        }

        displayMovies();

        document.getElementById('play-button').addEventListener('click', function() {
            var movieTitle = document.getElementById('movie-search').value.trim();
            if (movieTitle !== '') {
                fetch(`https://www.omdbapi.com/?apikey=e5a0f4ec&t=${encodeURIComponent(movieTitle)}`)
                    .then(response => response.json())
                    .then(data => {
                        if (data.Response === 'True') {
                            const movieData = {
                                title: data.Title,
                                id: data.imdbID,
                                year: data.Year
                            };
                            const jsonString = JSON.stringify(movieData);
                            window.location.href = 'movie.html?data=' + encodeURIComponent(jsonString);
                        } else {
                            alert('Title not found! Please try again.');
                        }
                    })
                    .catch(error => {
                        alert('Error fetching movie data. Please try again later.');
                        console.log(error);
                    });
            } else {
                alert('Please enter a movie title.');
            }
        });
    </script>
</body>
</html>
